---
title: フロントマター
---

# Goto〜Gosub〜イベント：制御の創世記

## 1. 太古の時代

太古の時代、GOTOありき。
プログラムの繰り返しは、ただひたすらに「ジャンプして戻る」ことで行われていた。

### Basic

```
1010 A=0
1020 A=A+1
1030 IF A=3 THEN GOTO 1050
1040 GOTO 1020
1050 PRINT A
```

---
## 2. サブルーチンの誕生

やがてGOSUBが登場する。
「行って戻ってくる」という、サブルーチンという概念の誕生である。

### Basic

```
1010 A=0
1020 GOSUB 2000
1030 GOSUB 2000
1040 GOSUB 2000
1050 END
2000 A=A+1
2010 PRINT A
2020 RETURN
```

これは、後の世に関数やメソッドと呼ばれるもののご先祖様である。

---
## 3. 自分都合から他者都合へ

呼び出したい時に呼び出すものはサブルーチンや関数。つまり、自分都合。
対して、呼び出されたい時に呼びされるものは、イベントやコールバック。つまり、他者都合。
たとえば、世界のどこかで愛が叫ばれたら呼ばれるイベント。

### C#

```
// イベントハンドラー登録
Love.Shout += Love_Shout;

// イベントハンドラー定義
Love_Shout(int x, int y) 
{
  Print("座標" + x + "," + y + "で愛が叫ばれた。");
}
```

イベントは += や AddHandler で、何が呼ばれるかを事前に指示する。
コールバックもまた、同じ真理を共有している。

### C#

```
main()
{
  MainLoop(SayHappy);
}

MainLoop(void *callback)
{
  while(true)
  {
    // 世界のどこかでLoveShoutフラグがONになると呼ばれる
    if (LoveShoutFlg == true) callback();
  }
}

SayHappy()
{
  Print("Happy!");
}
```

---
## 4. 抽象化の極地

イベントによって、私たちは「どんな時に呼ばれるか」を抽象化して考えられるようになった。

### イベント以前は：
「これこれこういう事が起きた時に、こういう処理をする」といちいち記述していた。

### イベント以後は：
「とりあえず処理だけ記述しておけば、良きタイミングで呼んでくれるよね」
となった。
すべては然るべき時に、然るべき場所で。
よきかなよきかな。

---
## 参考文献

### ハリウッド原則 (Hollywood Principle)
[制御の反転 - Wikipedia](https://ja.wikipedia.org/wiki/%E5%88%B6%E5%BE%A1%E3%81%AE%E5%8F%8D%E8%BB%A2)

「Don't call us, we'll call you.（こちらから呼ぶまで、君から呼ぶな）」という設計思想。
[Hollywood Principle - C2 Wiki](https://wiki.c2.com/?HollywoodPrinciple)
